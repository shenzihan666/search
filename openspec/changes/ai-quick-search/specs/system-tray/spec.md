# System Tray Specification

系统托盘常驻、右键菜单能力。

## ADDED Requirements

### Requirement: 最小化到系统托盘

系统 SHALL 在关闭窗口时最小化到系统托盘而非退出应用。

#### Scenario: 点击关闭按钮
- **WHEN** 用户点击窗口的关闭按钮
- **THEN** 窗口隐藏但应用继续在系统托盘运行

#### Scenario: 完全退出应用
- **WHEN** 用户右键托盘图标并选择"退出"
- **THEN** 应用完全退出，释放所有资源

### Requirement: 托盘图标

系统 SHALL 在系统托盘显示应用图标。

#### Scenario: 显示托盘图标
- **WHEN** 应用启动
- **THEN** 系统托盘显示应用图标

#### Scenario: 托盘图标状态
- **WHEN** 应用有查询正在进行
- **THEN** 托盘图标显示活动状态（如动画或不同颜色）

### Requirement: 托盘右键菜单

系统 SHALL 提供托盘图标的右键菜单。

#### Scenario: 显示菜单
- **WHEN** 用户右键点击托盘图标
- **THEN** 显示包含以下选项的菜单：
  - 显示/隐藏窗口
  - 设置
  - 关于
  - 退出

#### Scenario: 从菜单显示窗口
- **WHEN** 用户点击菜单中的"显示窗口"
- **THEN** 主窗口显示并获得焦点

#### Scenario: 从菜单打开设置
- **WHEN** 用户点击菜单中的"设置"
- **THEN** 打开设置窗口或切换到设置视图

### Requirement: 托盘单击行为

系统 SHALL 支持单击托盘图标显示窗口。

#### Scenario: 单击显示窗口
- **WHEN** 用户单击托盘图标且窗口处于隐藏状态
- **THEN** 主窗口显示并获得焦点

#### Scenario: 单击隐藏窗口
- **WHEN** 用户单击托盘图标且窗口处于显示状态
- **THEN** 主窗口隐藏

### Requirement: 启动时最小化

系统 SHALL 支持配置启动时是否直接最小化到托盘。

#### Scenario: 配置启动时最小化
- **WHEN** 用户在设置中启用"启动时最小化到托盘"
- **THEN** 应用启动后直接最小化到托盘，不显示主窗口

#### Scenario: 默认启动行为
- **WHEN** 应用首次启动且用户未修改设置
- **THEN** 应用启动后直接最小化到托盘（默认行为）
